(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{44:function(e,t,n){e.exports=n(85)},49:function(e,t,n){},59:function(e,t,n){},61:function(e,t,n){},63:function(e,t,n){},65:function(e,t,n){},67:function(e,t,n){},69:function(e,t,n){},78:function(e,t,n){},80:function(e,t,n){},82:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(26),l=n.n(r),o=(n(49),n(87)),c=n(88),s=n(86),u=n(89),m=n(90),h=n(5),d=n(16),p=n(21),g=n(39),E=n(6),f=Object(p.c)({person:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,data:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_PERSON":return Object(E.a)({},e,{isFetching:!0});case"RECEIVE_PERSON":return Object(E.a)({},e,{isFetching:!1,data:t.person});default:return e}},people:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,data:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_PEOPLE":return Object(E.a)({},e,{isFetching:!0});case"RECEIVE_PEOPLE":return Object(E.a)({},e,{isFetching:!1,data:t.people});default:return e}},profile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,data:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_PROFILE":return Object(E.a)({},e,{isFetching:!0});case"RECEIVE_PROFILE":return Object(E.a)({},e,{isFetching:!1,data:t.profile});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isLoggedIn:!1,isAnonymous:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_AUTH":return Object(E.a)({},e,{isFetching:!0});case"RECEIVE_AUTH":return Object(E.a)({},e,{isFetching:!1,isLoggedIn:t.isLoggedIn,isAnonymous:t.isAnonymous});default:return e}},username:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isChecking:!1,isUnique:!1,isFetching:!1,suggestion:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_USERNAME":return Object(E.a)({},e,{isChecking:!0});case"RECEIVE_USERNAME":return Object(E.a)({},e,{isChecking:!1,isUnique:t.isUnique});case"REQUEST_SUGGESTION":return Object(E.a)({},e,{isFetching:!0});case"RECEIVE_SUGGESTION":return Object(E.a)({},e,{isFetching:!1,suggestion:t.suggestion});default:return e}}}),v=n(10),b=n(11),N=n(13),y=n(12),k=n(14),w=function(e){return{type:"RECEIVE_USERNAME",isUnique:e}},C=function(e){return{type:"RECEIVE_SUGGESTION",suggestion:e}},O=function(e){return{type:"RECEIVE_PERSON",person:e}},S=function(e,t,n){if(e&&e.length)return e;if(t&&t.length||n&&n.length){var a="";return t&&t.length&&(a=t),n&&n.length&&(a.length?a+=" "+n:a=n),a}return""},I=function(e){return{type:"RECEIVE_AUTH",isLoggedIn:e.isLoggedIn,isAnonymous:e.isAnonymous}},U=function(e){return function(t){t({type:"REQUEST_AUTH"}),e.loginWithCredential(new d.a).then(function(){t(I({isLoggedIn:!0,isAnonymous:!0}))})}},L=function(e){function t(){return Object(v.a)(this,t),Object(N.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.client.auth;e.hasRedirectResult()?this.props.handleAuth(e):e.isLoggedIn?this.props.handleInitialAuth(e):this.props.loginAnonymously(e)}},{key:"render",value:function(){return this.props.children}}]),t}(i.a.Component),x=Object(h.b)(null,{handleAuth:function(e){return function(t){return t({type:"REQUEST_AUTH"}),t({type:"REQUEST_SUGGESTION"}),e.handleRedirectResult().then(function(e){t(I({isLoggedIn:!0,isAnonymous:!1}));var n=e.profile,a=n.name,i=n.firstName,r=n.lastName,l=S(a,i,r).toLowerCase().replace(/ /g,"-");t(C(l))})}},handleInitialAuth:function(e){return function(t){t({type:"REQUEST_AUTH"}),t({type:"REQUEST_SUGGESTION"});var n="anon-user"===e.user.loggedInProviderType;if(t(I({isLoggedIn:e.isLoggedIn,isAnonymous:n})),!n){var a=e.user.profile,i=a.name,r=a.firstName,l=a.lastName,o=S(i,r,l).toLowerCase().replace(/ /g,"-");t(C(o))}}},loginAnonymously:U})(L),j=d.e.initializeDefaultAppClient("correla-lptqk"),F=[g.a],A=Object(p.d)(f,p.a.apply(void 0,F)),R=function(e){var t=e.children;return i.a.createElement(h.a,{store:A},i.a.createElement(x,{client:j},t))},P=j.getServiceClient(d.d.factory,"mongodb-atlas").db("correla"),M=P.collection("people"),T=P.collection("usernames"),_=j.auth,z=function(e){return{type:"RECEIVE_AUTH",isLoggedIn:e,isAnonymous:!1}},D=function(e){var t=e.size;return i.a.createElement("div",{className:"loader",style:{width:"".concat(t,"rem"),height:"".concat(t,"rem")}})},V=function(){return i.a.createElement("div",{className:"account-loader"},i.a.createElement(D,{size:1.5}))},Q=function(){return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:"icon account-icon"},i.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"}),i.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},H=function(){return i.a.createElement(s.a,{to:"/account",className:"nav-link"},i.a.createElement(Q,null))},B=(n(59),function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(N.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(i)))).state={open:!1},n.toggleOpen=function(){return n.setState(function(e){return{open:!e.open}})},n.signOut=function(){n.toggleOpen(),n.props.logout()},n}return Object(k.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchPerson()}},{key:"render",value:function(){var e=this.props.person,t=this.state.open,n=e.isFetching,a=e.data;return n?i.a.createElement(V,null):!a||a&&0===Object.keys(a).length?i.a.createElement(H,null):i.a.createElement("div",{id:"account-modal-container"},i.a.createElement("div",{className:"nav-link",onClick:this.toggleOpen},i.a.createElement(Q,null)),t&&i.a.createElement("div",{id:"modal-overlay",onClick:this.toggleOpen}),i.a.createElement("div",{id:"account-modal",className:t?"open":""},i.a.createElement(s.a,{to:"/p/".concat(a.username),className:"modal-item",onClick:this.toggleOpen},"View profile"),i.a.createElement(s.a,{to:"/account",className:"modal-item",onClick:this.toggleOpen},"Edit profile"),i.a.createElement("div",{className:"modal-item",onClick:this.signOut},"Logout")))}}]),t}(i.a.Component)),q={fetchPerson:function(){return function(e){e({type:"REQUEST_PERSON"});var t=_.user.id;return M.find({uid:t},{limit:1}).first().then(function(t){return e(O(t))})}},logout:function(){return function(e){e({type:"REQUEST_AUTH"}),_.logout().then(function(){e(z(!1)),e(U(_))})}}},G=Object(h.b)(function(e){return{person:e.person}},q)(B),W=Object(h.b)(function(e){return{auth:e.auth}})(function(e){var t=e.auth,n=t.isFetching,a=t.isLoggedIn,r=t.isAnonymous;return n?i.a.createElement(V,null):a&&!r?i.a.createElement(G,null):i.a.createElement(H,null)}),$=n(15),J=(n(61),function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(N.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(i)))).state={name:"",identities:"",nearMe:"true"===window.sessionStorage.getItem("hasCoords"),showNearMe:!!window.navigator.geolocation,requestCoords:"true"===window.sessionStorage.getItem("hasCoords"),loadingCoords:!1,coords:"true"===window.sessionStorage.getItem("hasCoords")&&JSON.parse(sessionStorage.getItem("coords")),locationErrorMessage:""},n.handleInputChange=function(e){var t=e.target,a=t.name,i=t.value;n.setState(Object($.a)({},a,i))},n.handleCheckboxChange=function(e){var t=e.target.checked,a=n.state,i=a.requestCoords,r=a.loadingCoords;if(t&&!i&&!r)return n.setState({loadingCoords:!0,requestCoords:!0,nearMe:t}),void window.navigator.geolocation.getCurrentPosition(n.getLocation,n.handleLocationError);!t&&i&&r?n.setState({loadingCoords:!1,nearMe:t}):n.setState({nearMe:t})},n.getLocation=function(e){var t=e.coords;n.setState({coords:t,loadingCoords:!1}),window.sessionStorage.setItem("hasCoords","true"),window.sessionStorage.setItem("coords",JSON.stringify({latitude:t.latitude,longitude:t.longitude}))},n.handleLocationError=function(e){var t="An error occurred while getting your location.";switch(e.code){case e.PERMISSION_DENIED:t="You've denied requests for your location.";break;case e.POSITION_UNAVAILABLE:t="Location information is unavailable.";break;case e.TIMEOUT:t="The request to get your location timed out."}n.setState({locationErrorMessage:t,nearMe:!1,loadingCoords:!1})},n.getSearch=function(){var e=n.state,t=e.name,a=e.identities,i=e.nearMe,r=e.coords,l="?";return t&&(l+='name="'.concat(t.trim(),'"&')),a&&(l+='identities="'.concat(a.trim(),'"&')),i&&r&&(l+="nearMe=".concat(i,"&lat=").concat(r.latitude,"&lon=").concat(r.longitude,"&")),l.slice(0,-1)},n}return Object(k.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.state,t=e.name,n=e.identities,a=e.nearMe,r=e.showNearMe,l=e.loadingCoords,o=e.requestCoords,c=e.coords,u=e.locationErrorMessage;return i.a.createElement("section",{id:"search"},i.a.createElement("h1",{className:"title"},"Discover"),i.a.createElement("h2",{className:"subtitle"},"Find amazing people."),i.a.createElement("div",{id:"search-form"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"name-input"},"Name"),i.a.createElement("input",{type:"text",id:"name-input",name:"name",placeholder:"Name",value:t,maxLength:"120",onChange:this.handleInputChange})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"identities"},"Identities"),i.a.createElement("input",{type:"text",id:"identities",name:"identities",placeholder:"Identities",value:n,maxLength:"120",onChange:this.handleInputChange})),i.a.createElement("p",{className:"input-helper-text mtl"},"Separate identities with a comma."),r&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"form-group flex-align-center"},i.a.createElement("input",{type:"checkbox",id:"nearMe",name:"nearMe",checked:a,onChange:this.handleCheckboxChange,disabled:!l&&o&&!c}),i.a.createElement("label",{className:"checkbox-label mb",htmlFor:"nearMe"},"Near me")),i.a.createElement("div",{className:"input-helper-text mz"},l&&i.a.createElement("div",{id:"location-loader"},i.a.createElement(D,{size:1.125})),l?"Getting your location...":o?c?"Location received.":u:"This option will ask for your location.")),i.a.createElement(s.a,{id:"search-link",className:"button primary-action",to:{pathname:"/discover",search:this.getSearch()},disabled:l||t.length<1&&n.length<1&&!c&&!a},"Search")))}}]),t}(i.a.Component)),Y=function(){return i.a.createElement("div",{className:"page-loader"},i.a.createElement(D,{size:5}))},Z=function(){return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:"icon cake-icon"},i.a.createElement("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"}),i.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))},K=(n(63),function(e){var t=e.person;return i.a.createElement(s.a,{to:"/p/".concat(t.username),className:"person-item"},i.a.createElement("div",{className:"person-item-top"},i.a.createElement("div",{className:"person-item-section"},i.a.createElement("div",{className:"person-item-section-icon"},i.a.createElement(Q,null)),i.a.createElement("div",{className:"person-item-section-text person-name"},t.name)),!!t.locationName&&i.a.createElement("div",{className:"person-item-section person-city"},i.a.createElement("div",{className:"person-item-section-icon"},i.a.createElement(Z,null)),i.a.createElement("div",{className:"person-item-section-text"},t.locationName))),!!t.identitiesString&&!!t.identitiesString.length&&i.a.createElement("div",{className:"person-item-identities"},t.identitiesString))}),X=(n(65),function(e){var t=e.people;return i.a.createElement("section",{id:"people"},i.a.createElement("h1",{className:"title"},"Discover"),i.a.createElement("h2",{className:"subtitle"},"Find amazing people."),t.length?i.a.createElement("div",{id:"people-list"},t.map(function(e){return i.a.createElement(K,{key:e.username,person:e})})):i.a.createElement("div",{className:"empty-state"},i.a.createElement("p",{className:"no-results"},"No one found for that search.")))}),ee=function(e){function t(){return Object(v.a)(this,t),Object(N.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.location;(0,e.fetchPeople)(function(e){var t=new URLSearchParams(e),n={name:t.get("name"),identities:t.get("identities"),nearMe:t.get("nearMe"),lat:t.get("lat"),lon:t.get("lon")},a={};return n.name&&n.name.length&&(a.nameSearch={$in:n.name.replace(/"/gi,"").toUpperCase().split(" ").map(function(e){return e.trim()})}),n.identities&&n.identities.length&&(a.identitiesSearch={$in:n.identities.replace(/"/gi,"").toUpperCase().split(",").map(function(e){return e.trim()})}),"true"===n.nearMe&&n.lat&&n.lat.length&&!isNaN(Number(n.lat))&&n.lon&&n.lon.length&&!isNaN(Number(n.lon))&&(a.location={$near:{$geometry:{type:"Point",coordinates:[Number(n.lon),Number(n.lat)]},$maxDistance:5e4}}),a}(t.search))}},{key:"render",value:function(){var e=this.props.people,t=e.isFetching,n=e.data;return t?i.a.createElement(Y,null):i.a.createElement(X,{people:n})}}]),t}(i.a.Component),te={fetchPeople:function(e){return function(t){return t({type:"REQUEST_PEOPLE"}),M.find(e,{limit:50,projection:{name:1,username:1,locationName:1,identitiesString:1}}).asArray().then(function(e){return t(function(e){return{type:"RECEIVE_PEOPLE",people:e}}(e))})}}},ne=Object(h.b)(function(e){return{people:e.people}},te)(ee),ae=function(){return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:"icon cake-icon"},i.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),i.a.createElement("path",{d:"M12 6c1.11 0 2-.9 2-2 0-.38-.1-.73-.29-1.03L12 0l-1.71 2.97c-.19.3-.29.65-.29 1.03 0 1.1.9 2 2 2zm4.6 9.99l-1.07-1.07-1.08 1.07c-1.3 1.3-3.58 1.31-4.89 0l-1.07-1.07-1.09 1.07C6.75 16.64 5.88 17 4.96 17c-.73 0-1.4-.23-1.96-.61V21c0 .55.45 1 1 1h16c.55 0 1-.45 1-1v-4.61c-.56.38-1.23.61-1.96.61-.92 0-1.79-.36-2.44-1.01zM18 9h-5V7h-2v2H6c-1.66 0-3 1.34-3 3v1.54c0 1.08.88 1.96 1.96 1.96.52 0 1.02-.2 1.38-.57l2.14-2.13 2.13 2.13c.74.74 2.03.74 2.77 0l2.14-2.13 2.13 2.13c.37.37.86.57 1.38.57 1.08 0 1.96-.88 1.96-1.96V12C21 10.34 19.66 9 18 9z"}))},ie=(n(67),function(e){var t=e.name,n=e.birthday,a=e.locationName,r=e.identities,l=e.links;return i.a.createElement("section",{id:"profile"},i.a.createElement("h1",{id:"name-heading"},t),(!!n||!!a)&&i.a.createElement("h2",{id:"sub-heading"},!!n&&i.a.createElement("span",{className:"sub-span flex-align-center"},i.a.createElement(ae,null),function(e){var t=new Date(Date.now()-e);return Math.abs(t.getUTCFullYear()-1970)}(n)),!!a&&i.a.createElement("span",{className:"sub-span flex-align-center"},i.a.createElement(Z,null),a)),!!r&&i.a.createElement("div",{id:"identities",className:"chips profile-section"},r.map(function(e,t){return i.a.createElement("div",{key:"".concat(e,"-").concat(t),className:"chip"},i.a.createElement("span",{className:"chip-span"},e))})),!!l&&!!r&&i.a.createElement("hr",null),!!l&&i.a.createElement("div",{id:"links",className:"chips profile-section"},l.map(function(e,t){var n=e.name,a=e.url;return i.a.createElement("a",{className:"link-chip",href:a,target:"_blank",rel:"noopener noreferrer",key:"".concat(n,"-").concat(t)},i.a.createElement("span",{className:"chip-span"},n))})))}),re=function(e){return!(!e||!e.length)&&e},le=function(e){function t(){return Object(v.a)(this,t),Object(N.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match;(0,e.fetchProfile)(t.params.username)}},{key:"render",value:function(){var e=this.props,t=e.match,n=e.profile,a=t.params.username,r=n.isFetching,l=n.data;if(r)return i.a.createElement(Y,null);if(0===Object.keys(l).length)return i.a.createElement("div",{style:{padding:"2rem",textAlign:"center"}},'No person found with the username "'.concat(a,'".'));var o=function(e,t){var n=e||[];return t&&n.unshift({name:"Email",url:"mailto:".concat(t)}),n}(re(l.links),re(l.email));return i.a.createElement(ie,{name:l.name,birthday:!!l.showAge&&l.birthday,locationName:re(l.locationName),identities:re(l.identities),links:re(o)})}}]),t}(i.a.Component),oe={fetchProfile:function(e){return function(t){return t({type:"REQUEST_PROFILE"}),M.find({username:e},{limit:1,projection:{name:1,birthday:1,showAge:1,locationName:1,identities:1,email:1,links:1}}).first().then(function(e){return t(function(e){return{type:"RECEIVE_PROFILE",profile:e}}(e))})}}},ce=Object(h.b)(function(e){return{profile:e.profile}},oe)(le),se=(n(69),/^[a-z0-9-]{3,32}$/),ue=function(e){function t(e){var n;Object(v.a)(this,t),(n=Object(N.a)(this,Object(y.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target.value;n.setState({usernameInput:t,inputError:!se.test(t)})},n.tryNext=function(){(0,n.props.checkUsername)(n.state.usernameInput),n.setState(function(e){return{lastInput:e.usernameInput}})};var a=e.username.suggestion;return n.state={usernameInput:a,inputError:!1,lastInput:!1},n.isCreatingPerson=!1,n.receivedSuggestion=!!a.length,n}return Object(k.a)(t,e),Object(b.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.username,a=t.createPerson,i=n.isFetching,r=n.isChecking,l=n.isUnique,o=n.suggestion;if(!i&&!r){var c=this.state,s=c.lastInput,u=c.usernameInput;if(!e.username.isUnique&&l&&!this.isCreatingPerson)return this.isCreatingPerson=!0,void a(s);""!==e.username.suggestion||""===o||""!==u||this.receivedSuggestion||(this.receivedSuggestion=!0,this.setState({usernameInput:o}))}}},{key:"render",value:function(){var e=this.props.username,t=e.isFetching,n=e.isChecking,a=e.isUnique,r=this.state,l=r.usernameInput,o=r.inputError,c=r.lastInput;return t?i.a.createElement(Y,null):i.a.createElement("section",{id:"create-profile"},i.a.createElement("h1",{className:"title"},"Choose a username"),n?i.a.createElement(Y,null):a&&c?i.a.createElement(i.a.Fragment,null,i.a.createElement("p",{id:"congrats"},'Congrats! The username "'.concat(c,'" is yours!'),i.a.createElement("br",null),"Creating your profile now..."),i.a.createElement(Y,null)):i.a.createElement(i.a.Fragment,null,i.a.createElement("input",{type:"text",id:"username-input",className:o?"error":"",name:"username",placeholder:"Username",value:l,maxLength:"32",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onChange:this.handleInputChange}),o?i.a.createElement("p",{id:"username-input-error",className:"input-error-text"},"Usernames can only contain lowercase alphanumeric characters and hyphens and must be at least 3 characters long."):i.a.createElement("p",{className:"input-helper-text"},c?'Sorry, "'.concat(c,'" is already taken.'):"If the username is available, you can keep it!"),i.a.createElement("button",{id:"next",className:"button primary-action",onClick:this.tryNext,disabled:o},"Next")))}}]),t}(i.a.Component),me={createPerson:function(e){return function(t){t({type:"REQUEST_PERSON"});var n=_.user.id,a=_.user.profile,i=S(a.name,a.firstName,a.lastName);return M.insertOne({uid:n,username:e,name:i,nameSearch:i.length?i.toUpperCase().split(" "):[],birthday:a.birthday&&a.birthday.length?new Date(a.birthday).getTime():null,_birthday:a.birthday&&a.birthday.length?a.birthday:null,showAge:!(!a.birthday||!a.birthday.length),email:a.email&&a.email.length?a.email:null,identitiesString:"",identitiesSearch:[],identities:[],links:[],pictureUrl:a.pictureUrl&&a.pictureUrl.length?a.pictureUrl:null,_pictureUrl:a.pictureUrl,locationName:""}).then(function(a){var i=a.insertedId;T.insertOne({uid:n,username:e,pid:i}),M.find({_id:i},{limit:1}).first().then(function(e){return t(O(e))})})}},checkUsername:function(e){return function(t){return t({type:"REQUEST_USERNAME"}),T.find({username:e},{limit:1,projection:{username:1}}).first().then(function(e){e&&e.username&&e.username.length?t(w(!1)):t(w(!0))})}}},he=Object(h.b)(function(e){return{username:e.username}},me)(ue),de=n(31),pe=n(43),ge=n(42),Ee=n.n(ge),fe=(n(76),n(78),["Twitter","My Website","Facebook","Spotify"]),ve=["https://twitter.com/account","https://mywebsite.com/","https://www.facebook.com/username","https://open.spotify.com/user/account"],be=function(e){return e>=3?0:e+1},Ne=new Date,ye=new Date("1901-01-01"),ke=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&\/\/=]*)/,we=/^.+@(([a-z\-0-9]+\.)+[a-z]{2,6})$/,Ce=function(e){return e.map(function(e){return e.name+e.url}).join()},Oe=function(e,t){var n={};e.name!==t.name&&(n.name=t.name,n.nameSearch=t.name.toUpperCase().split(" ")),e.locationName!==t.locationName&&(n.locationName=t.locationName,n.location={type:"Point",coordinates:t.coordinates}),e.showAge!==t.showAge&&(n.showAge=t.showAge);var a=!!t.birthdayInput&&t.birthdayInput.getTime();if(a&&e.birthday!==a&&(n.birthday=a),e.email!==t.email&&(n.email=t.email),e.identitiesString!==t.identitiesInput)if(t.identitiesInput.trim().length){var i=t.identitiesInput.trim().split(",").map(function(e){return e.replace(",","").trim()});n.identities=i,n.identitiesSearch=i.map(function(e){return e.toUpperCase()}),n.identitiesString=t.identitiesInput.trim()}else n.identitiesString="",n.identities=[],n.identitiesSearch=[];return Ce(e.links)!==Ce(t.links)&&(n.links=t.links.filter(function(e){return!!e.name.length&&!!e.url.length})),n},Se=function(e){function t(e){var n;Object(v.a)(this,t),(n=Object(N.a)(this,Object(y.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target,a=t.name,i=t.value;n.setState(Object($.a)({},a,i))},n.handleUrlChange=function(e){var t,a=e.target,i=a.name,r=a.value;n.setState((t={},Object($.a)(t,i,r),Object($.a)(t,"newLinkUrlError",!!r.length&&!ke.test(r)),t))},n.handleEmailChange=function(e){var t,a=e.target,i=a.name,r=a.value;n.setState((t={},Object($.a)(t,i,r),Object($.a)(t,"emailError",!!r.length&&!we.test(r)),t))},n.handleBdayChange=function(e){n.setState({birthday:e.getTime(),birthdayInput:e})},n.handleCheckboxChange=function(e){var t=e.target.checked;n.setState({showAge:t})},n.addLink=function(){var e=n.state,t=e.newLinkName,a=e.newLinkUrl;t.length&&a.length&&ke.test(a)&&n.setState(function(e){return{newLinkName:"",newLinkUrl:"",links:Object(de.a)(e.links).concat([{name:e.newLinkName,url:e.newLinkUrl}]),linkPlaceholderIndex:be(e.linkPlaceholderIndex)}})},n.handleLinkNameChange=function(e){return function(t){var a=t.target.value;n.setState(function(t){var n=Object(de.a)(t.links);return n.splice(e,1,Object(E.a)({},t.links[e],{name:a})),{links:n}})}},n.handleLinkUrlChange=function(e){return function(t){var a=t.target.value;n.setState(function(t){var n=Object(de.a)(t.links),i={name:t.links[e].name,url:a},r=!ke.test(a);return r&&(i.urlError=!0),n.splice(e,1,i),{links:n,hasLinkUrlError:r&&!!a.length}})}},n.onPlaceSelected=function(e){n.setState({locationName:e.formatted_address,coordinates:[e.geometry.location.lng(),e.geometry.location.lat()]})},n.save=function(){var e=n.props,t=e.person,a=e.updatePerson,i=Oe(t,n.state);Object.keys(i).length>0&&a(t._id,i)};var a=e.person;return n.state={name:a.name||"",locationName:a.locationName||"",showAge:a.showAge,birthday:a.birthday,birthdayInput:a.birthday?new Date(a.birthday):null,email:a.email||"",identitiesInput:a.identitiesString||"",links:a.links&&a.links.length?a.links:[],newLinkName:"",newLinkUrl:"",newLinkUrlError:!1,linkPlaceholderIndex:Math.floor(4*Math.random()),hasLinkUrlError:!1,emailError:!1},n}return Object(k.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.name,a=t.locationName,r=t.showAge,l=t.birthdayInput,o=t.email,c=t.identitiesInput,s=t.links,u=t.newLinkName,m=t.newLinkUrl,h=t.newLinkUrlError,d=t.linkPlaceholderIndex,p=t.hasLinkUrlError,g=t.emailError;return i.a.createElement("section",{id:"account"},i.a.createElement("h1",{className:"title"},"Account"),i.a.createElement("h2",{className:"subtitle"},"Edit your profile."),i.a.createElement("div",{className:"account-form"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"name-input"},"Name"),i.a.createElement("input",{type:"text",id:"name-input",name:"name",placeholder:"Name",value:n,maxLength:"120",onChange:this.handleInputChange})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"location-input"},"Location"),i.a.createElement(Ee.a,{onPlaceSelected:this.onPlaceSelected,type:"text",id:"location-input",name:"locationName",placeholder:"Location",maxLength:"120",defaultValue:a})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"email-input"},"Email"),i.a.createElement("input",{type:"email",id:"email-input",name:"email",className:"email-input".concat(g?" error":""),placeholder:"Email",value:o,maxLength:"120",onChange:this.handleEmailChange})),g&&i.a.createElement("p",{className:"input-error-text"},"Please enter a valid email."),i.a.createElement("div",{id:"age-group"},i.a.createElement("div",{id:"show-age-group",className:"form-group flex-align-center"},i.a.createElement("input",{type:"checkbox",id:"showAge",name:"showAge",checked:r,onChange:this.handleCheckboxChange}),i.a.createElement("label",{id:"show-age-label",className:"checkbox-label",htmlFor:"showAge"},"Show age")),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"birthday-input"},"Birthday"),i.a.createElement(pe.a,{id:"birthday-input",placeholderText:"Birthday",minDate:ye,maxDate:Ne,dateFormat:"MMMM d, yyyy",selected:l,onChange:this.handleBdayChange,disabled:!r,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select"}))),i.a.createElement("div",{className:"links-group"},i.a.createElement("p",{className:"form-group-title"},"Links"),s.length<16&&i.a.createElement("div",{className:"new-link"},i.a.createElement("div",{className:"new-link-group"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"newLinkName-input"},"Name"),i.a.createElement("input",{type:"text",id:"newLinkName-input",name:"newLinkName",placeholder:fe[d],value:u,maxLength:"120",onChange:this.handleInputChange})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"newLinkUrl-input"},"URL"),i.a.createElement("input",{type:"text",id:"newLinkUrl-input",name:"newLinkUrl",className:h?"error":"",placeholder:ve[d],value:m,maxLength:"240",onChange:this.handleUrlChange}))),h&&i.a.createElement("p",{className:"url-input-error input-error-text"},"Please enter a valid URL."),i.a.createElement("button",{id:"add-link",className:"button",onClick:this.addLink,disabled:h},"Add new link")),s.length?i.a.createElement("div",{className:"link-list"},s.map(function(t,n){return i.a.createElement("div",{key:"link-".concat(n)},i.a.createElement("div",{className:"link-item"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"link-name-input-".concat(n)},"Name"),i.a.createElement("input",{type:"text",id:"link-name-input-".concat(n),name:"name",placeholder:"Name",value:t.name,maxLength:"120",onChange:e.handleLinkNameChange(n)})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"link-url-input-".concat(n)},"URL"),i.a.createElement("input",{type:"text",id:"link-url-input-".concat(n),name:"url",placeholder:"URL",className:t.urlError&&t.url.length?"error":"",value:t.url,maxLength:"240",onChange:e.handleLinkUrlChange(n)}))),!t.name.length&&!t.url.length&&i.a.createElement("p",{className:"input-helper-text"},"This link will be removed."),!t.name.length&&!!t.url.length&&i.a.createElement("p",{className:"input-error-text"},"Please enter a name or the link will be removed."),!t.url.length&&!!t.name.length&&i.a.createElement("p",{className:"input-error-text"},"Please enter a URL or the link will be removed."),!!t.urlError&&!!t.name.length&&!!t.url.length&&i.a.createElement("p",{className:"url-input-error input-error-text"},"Please enter a valid URL."))})):i.a.createElement("div",{className:"empty-link-list"},"Add links to your profiles and accounts on other websites or social media.")),i.a.createElement("div",{className:"identities"},i.a.createElement("p",{className:"form-group-title"},"Identities"),i.a.createElement("div",{className:"form-group identities-group"},i.a.createElement("textarea",{type:"text",id:"identities-input",name:"identitiesInput",placeholder:"Identities",maxLength:"200",value:c,onChange:this.handleInputChange})),i.a.createElement("p",{className:"input-helper-text mt"},"Separate identities with a comma."),c.trim().length?i.a.createElement("div",{className:"identity-chips chips"},c.trim().split(",").map(function(e,t){return e.replace(",","").trim().length?i.a.createElement("div",{key:"".concat(e,"-").concat(t),className:"chip"},i.a.createElement("span",{className:"chip-span"},e.replace(",","").trim())):null})):i.a.createElement("div",{className:"empty-identities"},"Add identities that describe you.",i.a.createElement("br",null),"(Example: Dad, Husband, Activist, Photographer, Producer, NYU alum, ENFP, Motorcyclist, Basketball player, Buddhist, Canadian)")),i.a.createElement("div",{id:"save"},i.a.createElement("button",{id:"save-button",className:"button primary-action",onClick:this.save,disabled:g||p},"Save"))))}}]),t}(i.a.Component),Ie={updatePerson:function(e,t){return function(n){return n({type:"REQUEST_PERSON"}),M.updateOne({_id:e},{$set:t}).then(function(t){M.find({_id:e},{limit:1}).first().then(function(e){return n(O(e))})})}}},Ue=Object(h.b)(function(e){return{person:e.person}},Ie)(function(e){var t=e.person,n=e.updatePerson,a=t.isFetching,r=t.data;return a?i.a.createElement(Y,null):!r||r&&0===Object.keys(r).length?i.a.createElement(he,null):i.a.createElement(Se,{person:r,updatePerson:n})}),Le=function(){return i.a.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"18px",height:"18px",viewBox:"0 0 48 48",className:"icon google-icon"},i.a.createElement("g",null,i.a.createElement("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),i.a.createElement("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),i.a.createElement("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),i.a.createElement("path",{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}),i.a.createElement("path",{fill:"none",d:"M0 0h48v48H0z"})))},xe=function(){return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 216 216",className:"icon facebook-icon",color:"#FFFFFF"},i.a.createElement("path",{fill:"#FFFFFF",d:" M204.1 0H11.9C5.3 0 0 5.3 0 11.9v192.2c0 6.6 5.3 11.9 11.9 11.9h103.5v-83.6H87.2V99.8h28.1v-24c0-27.9 17-43.1 41.9-43.1 11.9 0 22.2.9 25.2 1.3v29.2h-17.3c-13.5 0-16.2 6.4-16.2 15.9v20.8h32.3l-4.2 32.6h-28V216h55c6.6 0 11.9-5.3 11.9-11.9V11.9C216 5.3 210.7 0 204.1 0z"}))},je=(n(80),Object(h.b)(null,{loginWithGoogle:function(){return function(e){e({type:"REQUEST_AUTH"}),_.loginWithRedirect(new d.c).then(function(){e(z(!0))})}},loginWithFacebook:function(){return function(e){e({type:"REQUEST_AUTH"}),_.loginWithRedirect(new d.b).then(function(){e(z(!0))})}}})(function(e){var t=e.loginWithGoogle,n=e.loginWithFacebook;return i.a.createElement("section",{id:"sign-in",className:"flex-align-center"},i.a.createElement("div",{className:"center"},i.a.createElement("h1",{className:"title"},"Sign in"),i.a.createElement("button",{className:"button sign-in-button google-sign-in flex-align-center",onClick:t},i.a.createElement(Le,null),i.a.createElement("span",{className:"sign-in-button-text"},"Continue with Google")),i.a.createElement("button",{className:"button sign-in-button facebook-sign-in flex-align-center",onClick:n},i.a.createElement(xe,null),i.a.createElement("span",{className:"sign-in-button-text"},"Continue with Facebook"))))})),Fe=Object(h.b)(function(e){return{auth:e.auth}})(function(e){var t=e.auth,n=t.isFetching,a=t.isLoggedIn,r=t.isAnonymous;return n?i.a.createElement(Y,null):a&&!r?i.a.createElement(Ue,null):i.a.createElement(je,null)}),Ae=(n(82),function(){return i.a.createElement(o.a,{to:"/"})});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(function(){return i.a.createElement(R,null,i.a.createElement(c.a,{basename:""},i.a.createElement("div",null,i.a.createElement("header",null,i.a.createElement("nav",null,i.a.createElement("div",{className:"nav-link-c flex-align-center"},i.a.createElement(s.a,{to:"/",className:"nav-link"},"Correla")),i.a.createElement("div",{className:"nav-link-c nav-right flex-align-center"},i.a.createElement(W,null)))),i.a.createElement("main",null,i.a.createElement(u.a,null,i.a.createElement(m.a,{exact:!0,path:"/",component:J}),i.a.createElement(m.a,{path:"/discover",component:ne}),i.a.createElement(m.a,{path:"/p/:username",component:ce}),i.a.createElement(m.a,{path:"/account",component:Fe}),i.a.createElement(m.a,{component:Ae}))))))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[44,2,1]]]);
//# sourceMappingURL=main.0cedc05e.chunk.js.map